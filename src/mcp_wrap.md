# mcp_wrap

## なぜこの実装が存在するか

### JSON-RPC手書きの煩雑さ
**Problem**: MCPサーバーとの対話にはJSON-RPCプロトコルを手動で構築する必要があり、initializeやtools/callなどの定型的なメッセージを毎回書くのは煩雑で、開発効率を著しく低下させていた。

**Solution**: MCPプロトコルの詳細を隠蔽し、シンプルなCLIインターフェースで対話できるラッパーを作成。ユーザーは`tool_name {"param": "value"}`の形式で直感的にツールを呼び出せる。

### 対話的デバッグの必要性
**Problem**: MCPサーバーの開発やデバッグ時に、都度クライアントプログラムを書き直すのは非効率で、リアルタイムでの動作確認が困難だった。

**Solution**: REPLライクな対話セッションを提供し、サーバー起動から各種ツールの呼び出しまでを一つの実行で完結。開発者は即座にフィードバックを得られる。

### ツール発見とヘルプ機能の欠如
**Problem**: MCPサーバーが提供するツールやパラメータ仕様を知るために、別途ドキュメントを参照するか、コードを読む必要があり、学習コストが高かった。

**Solution**: 起動時に自動でtools/listを実行してツール一覧を表示し、/helpコマンドで各ツールの詳細なパラメータ仕様をYAML形式で確認可能とした。

### 適切なプロトコル処理の複雑さ
**Problem**: MCPでは通常のメソッド呼び出しとツール呼び出しで異なるプロトコル（直接呼び出し vs tools/call）を使い分ける必要があり、実装が複雑になりがちだった。

**Solution**: ツールキャッシュに基づいて自動判別し、ツールの場合はtools/callで適切にラップ、その他は直接呼び出しを行う透過的な処理を実装。

### レスポンス表示の可読性問題
**Problem**: JSON-RPCレスポンスをそのまま表示すると構造が分かりにくく、特に長いテキストコンテンツが含まれる場合の可読性が低かった。

**Solution**: YAML形式での表示とdefault_style='|'による複数行文字列の適切な折り畳み表示を採用し、構造化データを人間にとって読みやすい形で出力。