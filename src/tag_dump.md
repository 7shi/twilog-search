# tag_dump

## なぜこの実装が存在するか

### タグデータの分析可能性向上
**Problem**: batch/results.jsonlには22万件の投稿データのタグ情報が含まれているが、他の情報（reasoning、summary）も混在し、ファイルサイズが約128MBと大きく、タグのみを対象とした分析が困難だった。

**Solution**: タグ情報のみを抽出し、軽量で分析しやすいTSV形式での出力機能を実装。既存のBatchReaderクラスを活用することで、安全で効率的なデータ処理を実現。

### 出力形式の最適化選択
**Problem**: 投稿→タグ形式とタグ→投稿形式の2つの選択肢があり、どちらがより効率的かが不明だった。

**Solution**: 両方の形式でファイルサイズを比較検証し、投稿→タグ形式（13.5MB）がタグ→投稿形式（15.5MB）より約1.9MB小さいことを確認。データ量とメモリ効率を重視して投稿→タグ形式を採用。

### TSV形式による構造化データ対応
**Problem**: タグにカンマが含まれる場合、CSV形式ではエスケープ処理が複雑になり、パースエラーの原因となる可能性があった。

**Solution**: タグにタブ文字が含まれないことを前提に、TSV形式を採用。ヘッダー行付きの構造化データとして出力することで、表計算ソフトやデータ分析ツールでの直接利用を可能にした。

### 空タグ投稿の除外による分析対象の明確化
**Problem**: 22万件の投稿のうち、タグが付いていない投稿も含まれており、分析対象外のデータが混在していた。

**Solution**: タグが存在する投稿のみを出力対象とすることで、分析対象を明確化。実際にタグ分析に使用するデータのみに集中できる構造とした。

### タグ一覧出力による品質チェック機能
**Problem**: タグ→投稿形式は投稿数が極端に多いタグがあると非現実的な大きさになるが、タグの内容確認や品質チェックには必要だった。

**Solution**: setを使用してユニークなタグのみを収集し、ソート済みリストとしてtags.txtに出力する機能を追加。タグの内容確認と品質チェックに特化した軽量な形式を実現。