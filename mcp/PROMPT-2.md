# `search_similar` を使った効果的な調査方法

`search_similar`は、Twilogデータベースに対してベクトル検索を実行し、指定されたクエリに類似する投稿を検索する強力なツールです。このドキュメントでは、`search_similar`を効果的に活用するための方法をまとめます。

## 1. ツールの概要

`search_similar`は、入力された自然言語のクエリとTwilogデータベース内の投稿内容の類似度を計算し、関連性の高い投稿を返します。これにより、特定のキーワードだけでなく、意味的に近い内容の投稿も発見することができます。

## 2. 基本的な使い方

*   **`query` (検索クエリ):**
    *   調査したい内容を自然言語文で記述します。
    *   空文字列 (`""`) ではエラーとなるため、注意が必要です。
*   **`user_filter` (ユーザーフィルタリング):**
    *   特定のユーザーの投稿に絞って検索したい場合に利用します。
    *   `{"includes": ["ユーザーID1", "ユーザーID2"]}` の形式で指定します。`includes`を直接`search_similar`の引数に指定すると正しく機能しないため注意してください。
*   **`top_k` (表示件数制限):**
    *   検索結果の表示件数を指定します。デフォルト値は50件です。
    *   より多くの投稿を取得したい場合は、大きな値を指定する必要があります (例: `top_k=1000`)。

## 3. 効果的な調査方法

### 3.1. 特定の人物の調査

ある人物の興味や専門分野、人物像を深掘りしたい場合に非常に有効です。

1.  **全体像の把握:**
    *   まず、`user_filter`で対象人物を指定し、`query`は「人物の特徴が端的に表れているもの」として、その人物の投稿全体を把握します。
    *   `top_k`はあまり大きくしてもノイズになるので、20固定とします。
    ```python
    print(default_api.search_similar(query="人物の特徴が端的に表れているもの", user_filter={"includes": ["対象ユーザーID"]}, top_k=20))
    ```
2.  **特徴的なトピックの特定と深掘り:**
    *   取得した投稿内容をざっと読み、頻繁に言及されているキーワードや、興味深いと感じるトピックを特定します。
    *   特定したキーワードやトピックを`query`に設定し、再度`search_similar`を実行して深掘りします。
    ```python
    print(default_api.search_similar(query="特徴的なキーワード", user_filter={"includes": ["対象ユーザーID"]}, top_k=20))
    ```
3.  **反復的な深掘り:**
    *   深掘りした結果から、さらに新たなキーワードや関連概念を見つけ、それを次の検索クエリに利用するという反復的なプロセスを繰り返します。これにより、対象人物の興味や専門分野を多角的に掘り下げることができます。

### 3.2. 抽象的な概念の調査

`search_similar`で抽象的な概念を検索するときは、以下のアプローチが効率的です。

*   **関連キーワードの試行:** その抽象的な概念に関連する具体的なキーワードを複数試行し、検索結果から傾向を読み取ります。
*   **人物からのアプローチ:** その概念に詳しいと思われる人物を特定し、その人物の投稿を上記「特定の人物の調査」の方法で深掘りすることで、間接的に概念を調査します。

### 3.3. 結果の解釈と注意点

*   **類似度に基づく検索:** `search_similar`は、クエリと投稿内容の類似度に基づいて結果を返します。そのため、必ずしもユーザーの意図と完全に一致するとは限りません。検索結果は批判的に解釈し、文脈を考慮することが重要です。
*   **`user_filter`の正しい使い方:** `user_filter={"includes": [...]}` の形式で指定してください。

`search_similar`を効果的に活用することで、Twilogデータベースから深い洞察を得ることが可能になります。
